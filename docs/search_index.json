[["index.html", "BIA1401 - 2024 - Laboratoire 4 Chapitre 1 Heatmap 1.1 Exercices 1 - Genérer un heat map avec toutes les bactéries 1.2 Exercices 2 - Générer un heatmap mais avec vos trois inconnus", " BIA1401 - 2024 - Laboratoire 4 Chapitre 1 Heatmap 1.1 Exercices 1 - Genérer un heat map avec toutes les bactéries Téléchargez le fichier metabolic.csv que vous trouverez dans le dossier Labo 4 de Moodle. Une fois le téléchargement complété, ouvrez R Studio et créer un nouveau script. Vérifier ensuite le répertoire de travail et assurez-vous que le fichier metabolic.csv s’y trouve (rappelez-vous des commandes présentées au dernier laboratoire). Installer les librairies Ce sript requiert l’utilisation des Packages (librairies) suivants. Ces derniers ne sont pas nécessairement installés par défault, vous devrez donc utiliser l’onglet Packages afin de les installer. Package Fonctions reshape2 reshape() dyplr group_by() et mutate() ggplot2 ggplot() utilisée pour générer les figures scales scale_fill_distiller() pour la palette de couleur des figures Une autre option d’installation consiste à utiliser la fonction install.packages(). Charger les libraires Un package à besoin d’être installé qu’une seule fois, mais peut requérir des mises à jours sporadique. Une fois le package installé, pour utiliser une fonction se trouvant au sein de ce dernier, il ne suffit pas de simplement installer le package ; il faut également utiliser la fonction library() à chaque début de session R pour “charger” le package. library(dplyr) library(reshape2) library(ggplot2) library(scales) Importer le fichier Vous pouvez maintenant importer la table de données metabolic.csv dans R en utilisant la fonction read.table data = read.table(&quot;metabolic.csv&quot;, sep=&quot;,&quot;, header=TRUE, check.names=FALSE) Vous devriez maintenant être en mesure de voir l’objet data dans votre environnement. Je vous encourage à ouvrir ce tableau en cliquant sur celui-ci dans votre environnement. Vous devriez être en mesure de constater que le fichier contient 96 rangées et 11 colonnes. Les colones représentent l’identifiant unique du gènes (Gene_ID), le nom de la voie métabolique (Metabolism), le nom du module de la voie (Module) puis les différentes bactéries. Pour chacune des bactéries, une valeur de 1 indique la présence du gène alors qu’une valeur de 0 indique sont absence. Restructurer les données Afin de générer le heat map nous devons d’abord restructurer le tableau de données. Pour ce faire nous utiliserons la fonction metl. melted_df = melt(data) Je vous encourage maintenant à ouvrir ce tableau de comparer la disposition des données avec notre tableau original (data). Manipuler les données Nous allons ensuite utiliser des fonctions du Package dplyr afin de transformer nos données. Nous groupons (fonction group_by) en fonction des bactéries (colonne variable) et des modules (colonne module). Les valeurs regroupées par la fonction précédentes sont additionnées (fonction sum()) et conservées dans la nouvelle colonne Somme. Le nombre de rangées est dénombré (fonction n()) et conservé dans la nouvelle colonne Compte. Afin de récupérer le nom des voies métaboliques associées aux différents modules nous dégroupons nos données (fonction ungroup()). summarized_df = melted_df %&gt;% group_by(variable, Module) %&gt;% mutate(Somme = sum(value)) %&gt;% mutate(Compte = n()) %&gt;% ungroup() Finalement nous allons transformer nos valeurs en pourcentage. Cela vous permettra d’évaluer si vos bactéries possèdes l’ensemble des gènes associées à chacun des modules des différentes voies métaboliques. Pour ce faire les valeurs de la colonne Somme sont divisées par les valeurs de la colonne Compte puis multipliées par 100. summarized_df$Prop = summarized_df$Somme / summarized_df$Compte * 100 Générer la figure Nous pouvons maintenant générer la figure de type heat map pour représenter les données. heatmap_tous = ggplot(summarized_df, aes(x = variable, y = Module, fill = Prop)) + geom_tile(stat = &quot;identity&quot;, color = &quot;white&quot;) + scale_fill_distiller(palette = &quot;Oranges&quot;, direction = 1, guide = guide_colourbar(nbin = 100, draw.ulim = FALSE, draw.llim = FALSE)) + labs(fill = &quot;Proportion de gènes présents (%)&quot; ) + facet_grid(rows = vars(Metabolism), scales = &quot;free_y&quot;, space = &quot;free_y&quot;, labeller = label_wrap_gen(15)) + scale_x_discrete(position = &quot;bottom&quot;, expand=c(0,0)) + scale_y_discrete(expand=c(0,0), labels = wrap_format(20)) + theme_classic() + theme(plot.margin = unit(c(top = 0.5, right = 0.5, bottom = 0, left = 0.5), &#39;lines&#39;), panel.border = element_rect(colour = &quot;black&quot;, fill = NA, linewidth = 1), axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 10), axis.text.y = element_text(size = 10), axis.ticks.x = element_blank(), axis.ticks.y = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank(), plot.title = element_blank(), legend.position =&quot;bottom&quot;, legend.text = element_text(size = 10), legend.title = element_text(size = 10, hjust=0), strip.text.y.right = element_text(size = 10, angle = 0), strip.background = element_blank()) Nous vous invitons à rechercher sur internet ce qu’effectue chacun des paramètres et fonctions que nous utilisons avec la fonction ggplot()… on ne sait jamais, peut-être aurez vous à utiliser ces fonctions dans un future proche… Vous pouvez ensuite utiliser le symbole qui indique à R les commentaires pour annoter les fonctions et paramètres avec l’information que vous avez trouvée. Utilisez ensuite la fonction ggsave() pour enregistrer la figure produite. ggsave(filename = &quot;heat_map_all.png&quot;, plot = heatmap_tous, width = 10, height = 10, units = &quot;in&quot;, dpi = 500) 1.2 Exercices 2 - Générer un heatmap mais avec vos trois inconnus Nous avons vue au dernier laboratoire l’utilisation de la fonction subset() pour extraire uniquement certaines données définies d’un tableau de données. Effectuez une recherche internet afin de trouver comment utiliser cette fonction pour extraire vos trois inconnus du tableau de données melted_df. Vous devez ensuite exécuter de nouveau chacune des commandes à partir de la section Manipuler les données avec ce nouveau tableau de données afin d’obtenir un heat map avec uniquement vos trois bactéries. Cette figure est à inclure dans votre rapport de laboratoire. Bonne chance ! "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
